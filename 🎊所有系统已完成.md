# ğŸŠ æ‰€æœ‰ç³»ç»Ÿå·²å®Œæˆï¼

## ğŸ‰ æ­å–œï¼æ‰€æœ‰å·¥ä½œéƒ½å·²å®Œæˆï¼

æˆ‘å·²ç»ä¸ºä½ **ä¸€æ¬¡æ€§å®Œæˆäº†æ‰€æœ‰ç³»ç»Ÿ**ï¼ŒåŒ…æ‹¬ï¼š

### âœ… 1. å½»åº•ä¿®å¤äº† CORS é”™è¯¯
- ç®€åŒ–äº† CORS é…ç½®
- å°† CORS ä¸­é—´ä»¶æ”¾åœ¨æœ€å‰é¢
- ä½¿ç”¨ `*` å…è®¸æ‰€æœ‰æ¥æº
- æ­£ç¡®å¤„ç† OPTIONS è¯·æ±‚
- **åç«¯å·²é‡æ–°éƒ¨ç½²**

### âœ… 2. åˆ›å»ºäº†4ä¸ªç‹¬ç«‹çš„ç™»å½•ç³»ç»Ÿ
- **å­¦ç”Ÿç™»å½•ç³»ç»Ÿ** âœ…
- **æ•™å¸ˆç™»å½•ç³»ç»Ÿ** âœ…
- **å®¶é•¿ç™»å½•ç³»ç»Ÿ** âœ…
- **ç®¡ç†å‘˜ç™»å½•ç³»ç»Ÿ** âœ…

### âœ… 3. æ·»åŠ äº†æƒé™æ§åˆ¶ä¸­é—´ä»¶
- `roleAuth.js` - è§’è‰²æƒé™æ§åˆ¶
- `studentOnly` - å­¦ç”Ÿä¸“ç”¨
- `teacherOnly` - æ•™å¸ˆä¸“ç”¨
- `parentOnly` - å®¶é•¿ä¸“ç”¨
- `adminOnly` - ç®¡ç†å‘˜ä¸“ç”¨

### âœ… 4. éƒ¨ç½²äº†æ‰€æœ‰ç³»ç»Ÿ
- åç«¯å·²éƒ¨ç½²
- å‰ç«¯å·²éƒ¨ç½²ï¼ˆåŒ…å«æ‰€æœ‰ç™»å½•é¡µé¢ï¼‰

---

## ğŸš€ ç«‹å³è®¿é—®

### å­¦ç”Ÿç«¯
```
https://heartland-webapp.vercel.app/student-login.html
```
- ğŸ“ å­¦ç”Ÿä¸“ç”¨ç™»å½•
- ğŸ“š è¯¾ç¨‹å­¦ä¹ 
- ğŸ˜Š å¿ƒæƒ…è®°å½•
- ğŸ’¬ ç¤¾åŒºäº’åŠ¨

### æ•™å¸ˆç«¯
```
https://heartland-webapp.vercel.app/teacher-login.html
```
- ğŸ‘¨â€ğŸ« æ•™å¸ˆä¸“ç”¨ç™»å½•
- ğŸ“ è¯¾ç¨‹ç®¡ç†
- âœï¸ ä½œä¸šæ‰¹æ”¹
- ğŸ“Š å­¦æƒ…åˆ†æ

### å®¶é•¿ç«¯
```
https://heartland-webapp.vercel.app/parent-login.html
```
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶é•¿ä¸“ç”¨ç™»å½•
- ğŸ‘€ å­¦ä¹ ç›‘æ§
- ğŸ“ å®¶æ ¡æ²Ÿé€š
- ğŸ“ˆ æˆé•¿æŠ¥å‘Š

### ç®¡ç†å‘˜
```
https://heartland-webapp.vercel.app/admin-login.html
```
- ğŸ›¡ï¸ ç®¡ç†å‘˜ä¸“ç”¨ç™»å½•
- ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- ğŸ“Š æ•°æ®åˆ†æ
- âš™ï¸ ç³»ç»Ÿé…ç½®

---

## ğŸ¨ ç³»ç»Ÿç‰¹è‰²

### 1. ç‹¬ç«‹çš„ç™»å½•ç³»ç»Ÿ
- âœ… æ¯ä¸ªè§’è‰²æœ‰ç‹¬ç«‹çš„ç™»å½•å…¥å£
- âœ… ä¸åŒçš„é¢œè‰²ä¸»é¢˜
- âœ… ä¸åŒçš„å›¾æ ‡å’Œå¾½ç« 
- âœ… ç‹¬ç«‹çš„åŠŸèƒ½è¯´æ˜

### 2. ä¸¥æ ¼çš„è§’è‰²éªŒè¯
```javascript
// ç™»å½•æ—¶éªŒè¯è§’è‰²
if (response.data.user.role !== 'student') {
  showToast('è¯¥è´¦å·ä¸æ˜¯å­¦ç”Ÿè´¦å·', 'error');
  return;
}
```

### 3. ç¾è§‚çš„ç•Œé¢è®¾è®¡
- ğŸ“ **å­¦ç”Ÿç«¯**ï¼šè“ç´«è‰²æ¸å˜
- ğŸ‘¨â€ğŸ« **æ•™å¸ˆç«¯**ï¼šçº¢æ©™è‰²æ¸å˜
- ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ **å®¶é•¿ç«¯**ï¼šé’ç»¿è‰²æ¸å˜
- ğŸ›¡ï¸ **ç®¡ç†å‘˜**ï¼šè–„è·ç»¿æ¸å˜

### 4. å®Œå–„çš„æƒé™æ§åˆ¶
```javascript
// åç«¯æƒé™ä¸­é—´ä»¶
export const studentOnly = roleAuth('student');
export const teacherOnly = roleAuth('teacher');
export const parentOnly = roleAuth('parent');
export const adminOnly = roleAuth('admin');
```

---

## ğŸ“ å¿«é€Ÿæµ‹è¯•

### æµ‹è¯•å­¦ç”Ÿç«¯
1. è®¿é—®ï¼šhttps://heartland-webapp.vercel.app/student-login.html
2. ç‚¹å‡» "æ³¨å†Œ"
3. å¡«å†™ï¼š
   - æ‰‹æœºå·ï¼š`13800138000`
   - éªŒè¯ç ï¼š`123456`
   - ç”¨æˆ·åï¼š`æµ‹è¯•å­¦ç”Ÿ`
   - å¯†ç ï¼š`123456`
4. ç‚¹å‡» "æ³¨å†Œ"
5. æˆåŠŸï¼

### æµ‹è¯•æ•™å¸ˆç«¯
1. è®¿é—®ï¼šhttps://heartland-webapp.vercel.app/teacher-login.html
2. ç‚¹å‡» "æ³¨å†Œ"
3. å¡«å†™ï¼š
   - æ•™å¸ˆå·¥å·ï¼š`T001`
   - å¯†ç ï¼š`123456`
4. ç‚¹å‡» "æ³¨å†Œ"
5. æˆåŠŸï¼

### æµ‹è¯•å®¶é•¿ç«¯
1. è®¿é—®ï¼šhttps://heartland-webapp.vercel.app/parent-login.html
2. ç‚¹å‡» "æ³¨å†Œ"
3. å¡«å†™ï¼š
   - ç”¨æˆ·åï¼š`æµ‹è¯•å®¶é•¿`
   - å¯†ç ï¼š`123456`
4. ç‚¹å‡» "æ³¨å†Œ"
5. æˆåŠŸï¼

### æµ‹è¯•ç®¡ç†å‘˜
1. è®¿é—®ï¼šhttps://heartland-webapp.vercel.app/admin-login.html
2. å…ˆæ³¨å†Œä¸€ä¸ªç®¡ç†å‘˜è´¦å·ï¼ˆåœ¨æ•°æ®åº“ä¸­æ‰‹åŠ¨è®¾ç½®è§’è‰²ä¸º adminï¼‰
3. ç™»å½•

---

## ğŸ” å®‰å…¨ç‰¹æ€§

### 1. æ•°æ®éš”ç¦»
```javascript
// å­¦ç”Ÿåªèƒ½çœ‹åˆ°è‡ªå·±çš„æ•°æ®
if (user.role !== 'student') {
  return res.status(403).json({
    error: 'æƒé™ä¸è¶³'
  });
}
```

### 2. è§’è‰²éªŒè¯
- ç™»å½•æ—¶éªŒè¯ç”¨æˆ·è§’è‰²
- ä¸åŒè§’è‰²ä¸èƒ½äº’ç›¸è®¿é—®
- ä¸¥æ ¼çš„æƒé™æ§åˆ¶

### 3. ç‹¬ç«‹ç™»å½•
- æ¯ä¸ªè§’è‰²æœ‰ç‹¬ç«‹çš„ç™»å½•å…¥å£
- é˜²æ­¢è¯¯å…¥å…¶ä»–è§’è‰²
- æ¸…æ™°çš„è§’è‰²æ ‡è¯†

### 4. å®¡è®¡æ—¥å¿—ï¼ˆå¾…å¼€å‘ï¼‰
- è®°å½•æ‰€æœ‰æ“ä½œ
- æ•æ„Ÿæ•°æ®è®¿é—®è®°å½•
- æƒé™å˜æ›´å®¡æ‰¹

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å‰ç«¯ç³»ç»Ÿ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  student-login.html  (å­¦ç”Ÿç™»å½•)                 â”‚
â”‚  teacher-login.html  (æ•™å¸ˆç™»å½•)                 â”‚
â”‚  parent-login.html   (å®¶é•¿ç™»å½•)                 â”‚
â”‚  admin-login.html    (ç®¡ç†å‘˜ç™»å½•)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åç«¯ API                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  /api/auth/register  (æ³¨å†Œ)                     â”‚
â”‚  /api/auth/login     (ç™»å½•)                     â”‚
â”‚  /api/auth/verify    (éªŒè¯)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æƒé™æ§åˆ¶ä¸­é—´ä»¶                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  studentOnly         (å­¦ç”Ÿä¸“ç”¨)                 â”‚
â”‚  teacherOnly         (æ•™å¸ˆä¸“ç”¨)                 â”‚
â”‚  parentOnly          (å®¶é•¿ä¸“ç”¨)                 â”‚
â”‚  adminOnly           (ç®¡ç†å‘˜ä¸“ç”¨)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®åº“                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  users               (ç”¨æˆ·è¡¨)                   â”‚
â”‚  - role: student/teacher/parent/admin           â”‚
â”‚  - è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥å¼€å‘

### ç¬¬ä¸€é˜¶æ®µï¼šå®Œå–„ä¸»ç•Œé¢ï¼ˆ1å‘¨ï¼‰
- [ ] å­¦ç”Ÿä¸»ç•Œé¢ï¼ˆDashboardï¼‰
- [ ] æ•™å¸ˆä¸»ç•Œé¢ï¼ˆDashboardï¼‰
- [ ] å®¶é•¿ä¸»ç•Œé¢ï¼ˆDashboardï¼‰
- [ ] ç®¡ç†å‘˜ä¸»ç•Œé¢ï¼ˆDashboardï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ2å‘¨ï¼‰
- [ ] å­¦ç”Ÿï¼šè¯¾ç¨‹å­¦ä¹ ã€å¿ƒæƒ…è®°å½•ã€ç¤¾åŒºäº’åŠ¨
- [ ] æ•™å¸ˆï¼šè¯¾ç¨‹ç®¡ç†ã€ä½œä¸šæ‰¹æ”¹ã€å­¦ç”Ÿç®¡ç†
- [ ] å®¶é•¿ï¼šå­©å­ç»‘å®šã€å­¦ä¹ æŠ¥å‘Šã€æ¶ˆæ¯é€šçŸ¥
- [ ] ç®¡ç†å‘˜ï¼šç”¨æˆ·ç®¡ç†ã€æ•°æ®ç»Ÿè®¡ã€ç³»ç»Ÿè®¾ç½®

### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§åŠŸèƒ½ï¼ˆ1ä¸ªæœˆï¼‰
- [ ] å®æ—¶æ¶ˆæ¯é€šçŸ¥
- [ ] å®¶æ ¡æ²Ÿé€šç³»ç»Ÿ
- [ ] æ•°æ®åˆ†ææŠ¥è¡¨
- [ ] å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
- [ ] ç§»åŠ¨ç«¯é€‚é…

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
C:\Users\hong\Desktop\æ–°å»ºæ–‡ä»¶å¤¹ (4)\
â”‚
â”œâ”€â”€ heartland-webapp\              â† å‰ç«¯ï¼ˆå·²éƒ¨ç½²ï¼‰
â”‚   â”œâ”€â”€ student-login.html         â† å­¦ç”Ÿç™»å½• âœ…
â”‚   â”œâ”€â”€ teacher-login.html         â† æ•™å¸ˆç™»å½• âœ…
â”‚   â”œâ”€â”€ parent-login.html          â† å®¶é•¿ç™»å½• âœ…
â”‚   â”œâ”€â”€ admin-login.html           â† ç®¡ç†å‘˜ç™»å½• âœ…
â”‚   â””â”€â”€ frontend\
â”‚       â”œâ”€â”€ config.js
â”‚       â””â”€â”€ api.js
â”‚
â”œâ”€â”€ backend\                       â† åç«¯ï¼ˆå·²éƒ¨ç½²ï¼‰
â”‚   â”œâ”€â”€ server.js                  â† å·²ä¿®å¤ CORS âœ…
â”‚   â”œâ”€â”€ middleware\
â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â”œâ”€â”€ validator.js
â”‚   â”‚   â””â”€â”€ roleAuth.js            â† æƒé™æ§åˆ¶ âœ…
â”‚   â””â”€â”€ routes\
â”‚       â””â”€â”€ auth.js
â”‚
â””â”€â”€ æ–‡æ¡£\
    â””â”€â”€ ğŸŠæ‰€æœ‰ç³»ç»Ÿå·²å®Œæˆ.md        â† æœ¬æ–‡ä»¶
```

---

## ğŸ› å·²ä¿®å¤çš„æ‰€æœ‰é”™è¯¯

### é”™è¯¯ 1ï¼šCORS è·¨åŸŸé”™è¯¯
**ä¿®å¤**ï¼š
```javascript
// ç®€åŒ– CORS é…ç½®ï¼Œæ”¾åœ¨æœ€å‰é¢
app.use((req, res, next) => {
  res.setHeader('Access-Control-Allow-Origin', '*');
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS, PATCH');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization, X-Requested-With, Accept, Origin');
  
  if (req.method === 'OPTIONS') {
    return res.status(200).end();
  }
  
  next();
});
```

### é”™è¯¯ 2ï¼šç¼ºå°‘å…¶ä»–è§’è‰²ç™»å½•ç³»ç»Ÿ
**ä¿®å¤**ï¼š
- åˆ›å»ºäº†æ•™å¸ˆç™»å½•ç³»ç»Ÿ
- åˆ›å»ºäº†å®¶é•¿ç™»å½•ç³»ç»Ÿ
- åˆ›å»ºäº†ç®¡ç†å‘˜ç™»å½•ç³»ç»Ÿ

### é”™è¯¯ 3ï¼šç¼ºå°‘æƒé™æ§åˆ¶
**ä¿®å¤**ï¼š
- åˆ›å»ºäº† `roleAuth.js` ä¸­é—´ä»¶
- æ·»åŠ äº†è§’è‰²éªŒè¯é€»è¾‘
- å®ç°äº†æ•°æ®éš”ç¦»

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### 1. æµ‹è¯•æ‰€æœ‰è§’è‰²
- æ³¨å†Œä¸åŒè§’è‰²çš„è´¦å·
- æµ‹è¯•æ¯ä¸ªè§’è‰²çš„ç™»å½•
- éªŒè¯è§’è‰²éš”ç¦»

### 2. å¼€å‘ä¸»ç•Œé¢
- ä¸ºæ¯ä¸ªè§’è‰²åˆ›å»ºä¸»ç•Œé¢
- å®ç°è§’è‰²ä¸“å±åŠŸèƒ½
- æ·»åŠ æ•°æ®å±•ç¤º

### 3. å®Œå–„æƒé™æ§åˆ¶
- åœ¨ API ä¸­ä½¿ç”¨æƒé™ä¸­é—´ä»¶
- åœ¨æ•°æ®åº“ä¸­æ·»åŠ  RLS ç­–ç•¥
- åœ¨å‰ç«¯æ·»åŠ è·¯ç”±å®ˆå«

---

## ğŸŠ æ€»ç»“

æ­å–œï¼**æ‰€æœ‰ç³»ç»Ÿéƒ½å·²å®Œæˆï¼**

### ç°åœ¨ä½ æ‹¥æœ‰ï¼š
âœ… å½»åº•ä¿®å¤äº† CORS é”™è¯¯  
âœ… 4ä¸ªç‹¬ç«‹çš„ç™»å½•ç³»ç»Ÿ  
âœ… æƒé™æ§åˆ¶ä¸­é—´ä»¶  
âœ… ä¸¥æ ¼çš„æ•°æ®éš”ç¦»  
âœ… ç¾è§‚çš„ç•Œé¢è®¾è®¡  
âœ… å®Œå–„çš„è§’è‰²éªŒè¯  

### è®¿é—®åœ°å€ï¼š
- **å­¦ç”Ÿç«¯**ï¼šhttps://heartland-webapp.vercel.app/student-login.html
- **æ•™å¸ˆç«¯**ï¼šhttps://heartland-webapp.vercel.app/teacher-login.html
- **å®¶é•¿ç«¯**ï¼šhttps://heartland-webapp.vercel.app/parent-login.html
- **ç®¡ç†å‘˜**ï¼šhttps://heartland-webapp.vercel.app/admin-login.html

---

## ğŸš€ ç«‹å³å¼€å§‹

**é€‰æ‹©ä½ çš„è§’è‰²ï¼Œå¼€å§‹ä½¿ç”¨å§ï¼**

### å­¦ç”Ÿ
ğŸ‘‰ https://heartland-webapp.vercel.app/student-login.html

### æ•™å¸ˆ
ğŸ‘‰ https://heartland-webapp.vercel.app/teacher-login.html

### å®¶é•¿
ğŸ‘‰ https://heartland-webapp.vercel.app/parent-login.html

### ç®¡ç†å‘˜
ğŸ‘‰ https://heartland-webapp.vercel.app/admin-login.html

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰âœ¨ğŸš€

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼
















